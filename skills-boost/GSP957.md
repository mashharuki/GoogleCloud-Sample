# GKE Autopilot: Qwik Start

## GKE Autopilot 概要と特徴

### 概要
**Google Kubernetes Engine（GKE）Autopilot** は、新しいマネージド運用モードです。  

Google がアプリケーションのワークロードを実行するために必要な物理インフラを **構築・サイズ決定・自動スケーリング** します。

このラボでは、以下を実践します。

- アプリケーションのコンテナ化
- Kubernetes 構成ファイルとコマンドを使用して、GKE Autopilot クラスタにデプロイ

---

### Autopilot による GKE の簡素化

#### 基本構造
- **ノード**：個々のコンピュートインスタンス
- **クラスタ**：複数のノードの集合
- **基盤**：Kubernetes（Google の 15 年以上の本番運用経験に基づくオープンソースのクラスタオーケストレーションプラットフォーム）

Kubernetes は Google の設計原則を活かし、以下を提供します：
- 自動管理
- アプリケーションコンテナの監視と稼働状態（liveness）確認
- 自動スケーリング
- ローリングアップデート

---

### GKE Autopilot のメリット
- 高可用性・セキュリティのベストプラクティスに基づくクラスタの最適化と構成
- クラスタ健全性の監視
- ワークロード実行に必要なクラスタ容量の自動計算

---

### 開発者への価値
- 運用保守から解放され、アプリケーション開発に集中可能
- Kubernetes を利用して、ステートレスサービスとステートフルサービスの両方を運用可能

## ハンズオンの記録

GitHubをクローンしてくる

Cloud Codeで開く

```bash
git clone https://github.com/subfuzion/voting-demo.git
```

Add the cluster credentials to the local kube-config

```bash
gcloud container clusters get-credentials dev-cluster --region us-east4
```

podのビルドとデプロイを行う

```bash
cd ~/voting-demo/v2
gcloud config set compute/region us-east4  
```

デプロイ

```bash
skaffold run --default-repo=gcr.io/qwiklabs-gcp-01-471724157770/voting-app --tail
```

アプリの実行

```bash
kubectl get svc web-external --output=json | jq -r .status.loadBalancer.ingress[0].ip
```

デプロイしたクラスターなど一式を削除する

```bash
skaffold delete
```

## 参考文献
- [GKE Autopilot](https://cloud.google.com/kubernetes-engine/docs/concepts/autopilot-overview?hl=ja)
- [デモの用のGitHub](https://github.com/subfuzion/voting-demo)
- [デモ用のGitHubのDeepwiki](https://deepwiki.com/subfuzion/voting-demo)
